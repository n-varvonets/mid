
# Разница между агрегацией и композицией

**Агрегация** и **композиция** — это два типа ассоциаций между объектами в объектно-ориентированном программировании (ООП). Оба типа описывают отношение "часть-целое" между объектами, но есть ключевые различия в том, как эти отношения работают.

## 1. Агрегация

**Агрегация** — это слабая форма связи, которая описывает отношения "часть-целое", но "части" могут существовать отдельно от "целого". Агрегат не владеет своими частями полностью, и они могут существовать независимо.

### Пример агрегации:
Представим, что у нас есть классы `University` и `Student`. Университет может включать студентов, но студенты могут существовать и без университета. Удаление университета не означает удаление студентов.

```python
class Student:
    def __init__(self, name):
        self.name = name

class University:
    """
    если университет будет удалён, студенты могут продолжать существовать — их можно ассоциировать
    с другим университетом или оставить существовать как отдельные объекты.
    """
    def __init__(self, name):
        self.name = name
        self.students = []

    def add_student(self, student):
        self.students.append(student)

# Пример
student1 = Student("Alice")
university = University("MIT")
university.add_student(student1)
```

```python
class Book:
    def __init__(self, title):
        self.title = title

class Library:
    """
    В библиотеке есть множество книг, но каждая книга может существовать 
    отдельно от библиотеки. Книга может быть переведена в другую библиотеку или продана.
    Удаление библиотеки не означает, что все книги будут уничтожены.
    """
    def __init__(self):
        self.books = []

    def add_book(self, book):
        self.books.append(book)

# Пример
library = Library()
book1 = Book("The Great Gatsby")
library.add_book(book1)

```

## 2. Композиция

**Композиция** — это более сильная связь, где "части" не могут существовать отдельно от "целого". Композиция подразумевает, что "целое" владеет своими "частями", и если "целое" уничтожается, то его "части" также уничтожаются.

### Пример композиции:
Представим, что у нас есть классы `Car` и `Engine`. Двигатель не может существовать без машины. Если машина будет уничтожена, то и двигатель будет уничтожен.

```python
class Engine:
    def __init__(self, horsepower):
        self.horsepower = horsepower

class Car:
    def __init__(self, model):
        self.model = model
        self.engine = Engine(400)

# Пример
car = Car("Tesla Model S")
```

### Схема композиции:
```
+--------+         1        +--------+
|  Car   |----------------->| Engine |
+--------+                   +--------+
```

## Различия между агрегацией и композицией

| Характеристика       | Агрегация                           | Композиция                        |
|----------------------|-------------------------------------|-----------------------------------|
| Сила связи           | Слабая (части могут существовать отдельно) | Сильная (части не могут существовать без целого) |
| Взаимозависимость     | Части могут существовать независимо | Части зависят от существования целого |
| Жизненный цикл       | Части могут пережить целое          | Части уничтожаются вместе с целым |
| Пример               | Студенты и университет              | Двигатель и автомобиль            |

### Заключение
Агрегация и композиция представляют разные уровни зависимости между объектами. Агрегация описывает слабую связь, где объекты могут существовать независимо друг от друга, тогда как композиция создаёт сильную зависимость, где "части" не могут существовать без "целого".


---



# Агрегация и композиция в Django

В Django отношения агрегации и композиции между моделями могут быть выражены через различные типы связей, такие как **OneToMany** (один ко многим) с разными стратегиями удаления.

## 1. Агрегация

**Агрегация** означает, что зависимый объект может существовать независимо от "хозяина". Это можно моделировать с помощью `ForeignKey` с параметрами `null=True` и `on_delete=models.SET_NULL`. Если "хозяин" удаляется, зависимый объект остаётся, но связь обнуляется (становится `NULL`).

### Пример агрегации:

```python
from django.db import models

class Student(models.Model):
    name = models.CharField(max_length=100)

class University(models.Model):
    name = models.CharField(maxlength=100)
    students = models.ForeignKey(Student, null=True, on_delete=models.SET_NULL)
```
- **null=True**: Студенты могут существовать без университета.
- **on_delete=models.SET_NULL**: Если университет удаляется, поле `students` становится `NULL`, но студент остаётся.

## 2. Композиция

**Композиция** — это более сильная связь, где зависимый объект не может существовать без "хозяина". Если "хозяин" удаляется, зависимый объект также должен быть удалён. В Django это моделируется с помощью `ForeignKey` с параметром `on_delete=models.CASCADE`.

### Пример композиции:

```python
from django.db import models

class Engine(models.Model):
    horsepower = models.IntegerField()

class Car(models.Model):
    model = models.CharField(max_length=100)
    engine = models.ForeignKey(Engine, on_delete=models.CASCADE)
```
- **on_delete=models.CASCADE**: Если объект `Car` удаляется, связанный объект `Engine` также будет удалён.

## Заключение:

- **Агрегация**: Зависимый объект может существовать независимо. В Django это моделируется через `ForeignKey` с `null=True` и `on_delete=models.SET_NULL`.
- **Композиция**: Зависимый объект полностью зависит от "хозяина". В Django это моделируется через `ForeignKey` с `on_delete=models.CASCADE`.
